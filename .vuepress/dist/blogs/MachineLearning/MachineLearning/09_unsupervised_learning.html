<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <title>3-1 无监督学习 | AoSaiX</title><meta name="description" content="Blog for study, life and hobby.">
    <link rel="preload" href="/blog-vp-reco/assets/style-CO2hMFE6.css" as="style"><link rel="stylesheet" href="/blog-vp-reco/assets/style-CO2hMFE6.css">
    <link rel="modulepreload" href="/blog-vp-reco/assets/app-P8O63--9.js"><link rel="modulepreload" href="/blog-vp-reco/assets/09_unsupervised_learning.html-CbLl92H7.js">
    <link rel="prefetch" href="/blog-vp-reco/assets/timeline.html-BdJQ0mvw.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/posts.html-Bc1E7R2o.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/friendship-link.html-By2dk8OB.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/custom-page.html-BYkYIePG.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BSOTAWV7.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DjHZ-0VC.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BTBDoDs7.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DRSq8j_f.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/2.html-atztc-iS.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-B9QKNHuH.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BpFG0qSD.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BvXlC1IN.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DAi-M6x6.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-B0wFdafP.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DKnc07sy.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-PaUmAeQt.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BxM40LCl.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-nsXZ1qjR.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-C4LuENmB.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DuCOthnw.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-C3ZuT9tS.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-C9jv4Sqb.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-5ZgsUq_f.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-2tLWhxKw.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BPf6exi_.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-CG2Q8c6h.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-D1uTAsCH.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-XVWLnc_N.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-OUQfsSMe.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-TUvA1hOb.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-CayeZCAz.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-C-Ul7X7h.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-34oRPQBX.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-EZsB9NLR.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-5Aif7w_k.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BvWu308X.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-gS_C1Hww.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-75Kg7CII.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-bxyAmrVV.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-1NGbAeoz.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BzooenBi.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-99kYxV7U.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-sSfTUfCP.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-Dp_NTCIN.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-CmGgfcYm.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-Db6WyAY-.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-BfF2chF0.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DWVEDDG8.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DfgO2xSb.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-COOrpJu_.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DfrZOlEf.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-C0cP1kmh.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-Cxb7w7Pz.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DONY0Bd6.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-Bsba4raH.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-CNt-XijK.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/1.html-DRnczId7.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/2.html-CzOfFiqN.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/3.html-CyknjLjZ.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/4.html-DkJdTfG3.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/5.html-CHImye19.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/index.html-BcwoWC7x.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/update_record.html-C1V8svZR.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/vuepress-recojiaocheng.html-Doq0mU0A.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_compress_photo.html-kAsnudyJ.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_file_packaging.html-qB8raCfR.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_pyqt5_recording.html-DMCu8s1P.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/04_spider_for_ticket.html-CQ5Jovzn.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/index.html-XWkzsVHn.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/Introduction.html-GSwY785t.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/Introduction.html--BI5al3m.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_xxx.html-bg7OYjge.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_xxx.html-PYvRvZBM.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_bairuzongmen.html-B_LWPzht.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_aolianjingu.html-Cy4AVlr1.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_zongshu.html-X4Vqf4sR.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_tuxiangxiufurumen.html-IfRoIR6X.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_xxx.html-Cdfdtr8M.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_zongshu.html-C7cZwQIU.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_jichucaozuo.html-lbqclcG0.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_zaoshengyulvbo.html-rnYC7_MK.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/04_xinhaoyutuxiang.html-DglmsVZ7.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/05_xingtaixueyutezheng.html-BDpX9bhS.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/06_yasuoyubianma.html-DHv7A7FM.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_zongshu.html-suXj987-.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_xxx.html-Dj6lQ5Ac.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_xxx.html-CbcscO3s.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_fargoing.html-Cf0aCvEQ.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_shanxi.html-DgfFZMMr.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_sichuan.html-C1z1N4e8.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/00.html-DWFxMFLA.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01.html-enhPGKIS.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_base.html-ySCK6V26.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_project1.html-CwBq-a0v.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_project2.html-i5I9XEqk.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_project1.html-DPc66BQ-.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/index.html-D0hKYeWN.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_introduction.html-B9Of61s1.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/02_linear_regression.html-B5B0AESm.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/03_linear_regression.html-vbH4E1uw.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/04_classification.html-BwnEU7im.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/05_deep_learning.html-CTox31z_.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/06_tensorflow.html-KDo33jSy.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/07_model_evaluation.html-dQAuxDEM.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/08_decision_tree.html-UBUXlGpt.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/10_recommendation_system.html-BuWKv7Rs.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/11_reinforcement_learning.html-QFrspMNL.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/00_introduction.html-ZZbrmaDB.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/01_recommend_model.html-dXnSIzAW.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/LA1.html-DYiAebD6.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/LA2.html-D71k2RQQ.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/LA3.html-e3LtLxps.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/LA4.html-Damo6x8r.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/ML1.html-BrOk26DW.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/404.html-CRo86Wkf.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/Valine.min-_LyT3bfY.js" as="script"><link rel="prefetch" href="/blog-vp-reco/assets/giscus-aTimukGI-DWEKOTfS.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container show-series show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/blog-vp-reco/logo1.svg" alt="AoSaiX"><a href="/blog-vp-reco/" class="site-name can-hide">AoSaiX</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="机器学习"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->机器学习<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="机器学习"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->机器学习<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/01_introduction" class="link" aria-label="机器学习(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->机器学习(未整理)<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/MachineLearning/recommendationSystem/00_introduction" class="link" aria-label="推荐系统(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->推荐系统(未整理)<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="数据锻造坊"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->数据锻造坊<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="数据锻造坊"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->数据锻造坊<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/DataFoundry/Numpy/01_拜入宗门" class="link" aria-label="Numpy"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Numpy<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/DataFoundry/Matplotlib/01_xxx" class="link" aria-label="Matplotlib"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Matplotlib<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="深度学习"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->深度学习<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="深度学习"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->深度学习<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/DeepLearning/PyTorch/README.md" class="link" aria-label="PyTorch(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->PyTorch(未整理)<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="计算机视觉"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->计算机视觉<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="计算机视觉"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->计算机视觉<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/ComputerVision/ImageProcessing/01_综述" class="link" aria-label="图像处理"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->图像处理<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/ComputerVision/ImageGeneration/01_综述" class="link" aria-label="图像生成"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->图像生成<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/ComputerVision/TargetDetection/01_综述" class="link" aria-label="目标检测"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->目标检测<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="每日一题"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->每日一题<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="每日一题"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->每日一题<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/CodeExam/AI/Introduction" class="link" aria-label="AI算法篇"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->AI算法篇<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="书院二层楼"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->书院二层楼<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="书院二层楼"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->书院二层楼<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><!--[--><h5 class="dropdown-link__subtitle"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Reco内置<!--]--></span></span></h5><ul class="dropdown-link__subcontainer"><!--[--><li class="dropdown-link__subitem"><a href="/blog-vp-reco/timeline" class="link" aria-label="时间轴"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->时间轴<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__subitem"><a href="/blog-vp-reco/friendship-link" class="link" aria-label="友情链接"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->友情链接<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-link__item"><!--[--><h5 class="dropdown-link__subtitle"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->个人手札<!--]--></span></span></h5><ul class="dropdown-link__subcontainer"><!--[--><li class="dropdown-link__subitem"><a href="/blog-vp-reco/docs/update_record" class="link" aria-label="更新日志"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->更新日志<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__subitem"><a href="/blog-vp-reco/docs/desktop_app/README.md" class="link" aria-label="桌面软件开发(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->桌面软件开发(未整理)<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="逐趣成章"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->逐趣成章<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="逐趣成章"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->逐趣成章<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/Hobbies/mahjong/01_fargoing" class="link" aria-label="雀神之路(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->雀神之路(未整理)<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blog-vp-reco/blogs/Hobbies/musictheroy/00" class="link" aria-label="音乐科学(未整理)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->音乐科学(未整理)<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><li class="social-item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:25px;height:25px;"><path d="M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z" fill-rule="evenodd" fill="currentColor"></path></svg></li><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><header class="sub-navbar-container not-open"><span class="nav-item"><div class="toggle-series-button" aria-expanded="false" role="button" tabindex="0"><span></span><span></span><span></span></div> Series </span></header><!----><!----><div class="theme-main" style=""><aside class="series-container"><!--[--><!--[--><section class="series-group series-item"><h5 class="series-heading series-level-1 active"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:16px;"><!--[-->机器学习<!--]--></span></span><span class="arrow down"></span></h5><ul style="display:block;"><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/01_introduction.html" class="link series-item series-item" aria-label="0-0 机器学习目录与概述"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->0-0 机器学习目录与概述<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/02_linear_regression.html" class="link series-item series-item" aria-label="1-1 一元线性回归"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->1-1 一元线性回归<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/03_linear_regression.html" class="link series-item series-item" aria-label="1-2 多元线性回归"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->1-2 多元线性回归<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/04_classification.html" class="link series-item series-item" aria-label="1-3 分类问题"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->1-3 分类问题<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/05_deep_learning.html" class="link series-item series-item" aria-label="2-1 神经网络初探"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2-1 神经网络初探<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/06_tensorflow.html" class="link series-item series-item" aria-label="2-2 神经网络进阶"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2-2 神经网络进阶<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/07_model_evaluation.html" class="link series-item series-item" aria-label="2-3 模型评估"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2-3 模型评估<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/08_decision_tree.html" class="link series-item series-item" aria-label="2-4 决策树模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2-4 决策树模型<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html" class="router-link-active router-link-exact-active link router-link-active series-item series-item" aria-label="3-1 无监督学习"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3-1 无监督学习<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/10_recommendation_system.html" class="link series-item series-item" aria-label="3-2 推荐系统"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3-2 推荐系统<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/11_reinforcement_learning.html" class="link series-item series-item" aria-label="3-3 强化学习"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3-3 强化学习<!--]--></span></span><!--[--><!--]--></a><!--]--></li></ul></section><!--]--><!--[--><section class="series-group series-item"><h5 class="series-heading series-level-1"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:16px;"><!--[-->推荐系统<!--]--></span></span><span class="arrow down"></span></h5><ul style="display:block;"><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/recommendationSystem/00_introduction.html" class="link series-item series-item" aria-label="推荐系统基础 - 01"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->推荐系统基础 - 01<!--]--></span></span><!--[--><!--]--></a><!--]--></li><li><!--[--><a href="/blog-vp-reco/blogs/MachineLearning/recommendationSystem/01_recommend_model.html" class="link series-item series-item" aria-label="推荐系统基础 - 02"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->推荐系统基础 - 02<!--]--></span></span><!--[--><!--]--></a><!--]--></li></ul></section><!--]--><!--]--></aside><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">3-1 无监督学习</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->AoSaiX<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2024-08-16<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog-vp-reco/categories/jiqixuexi/1.html" class="">机器学习</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog-vp-reco/tags/wujianduxuexi/1.html" class="">无监督学习</a><a href="/blog-vp-reco/tags/juleisuanfa/1.html" class="">聚类算法</a><a href="/blog-vp-reco/tags/yichangjiancesuanfa/1.html" class="">异常检测算法</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><p>无监督学习（Unsupervised Learning）</p><p>在这一章中，将会提到<strong>聚类算法</strong>、<strong>异常检测</strong>两种无监督学习算法。这两个技术都是当今许多公司在重要商业领域中使用的技术。</p><h2 id="_1-什么是聚类" tabindex="-1"><a class="header-anchor" href="#_1-什么是聚类"><span>1. 什么是聚类</span></a></h2><p><strong>聚类算法：查看大量数据点，并自动找到彼此相关或相似的数据点</strong>。具体什么意思呢？我们来对比一下聚类算法和分类算法：</p><div class="layout"><figure><img src="/blog-vp-reco/machinelearning/four/09-01.png" alt="9.1 分类算法" width="360" tabindex="0" loading="lazy"><figcaption>9.1 分类算法</figcaption></figure><figure><img src="/blog-vp-reco/machinelearning/four/09-02.png" alt="9.2 聚类算法" width="360" tabindex="0" loading="lazy"><figcaption>9.2 聚类算法</figcaption></figure></div><p>图 9.1 是一个分类算法。数据集中给定了两个特征 x1 和 x2，以及对应的目标标签 y，通过逻辑回归算法或者神经网络，划分出这样一个边界，通过这个边界，对新的数据进行预测。</p><p>聚类算法（clustering），数据集中只包含特征 x 向量，而没有目标标签 y，因此我们无法让该算法预测我们想要预测的“正确答案”。相反，我们要求算法找到有关数据的有趣内容。比如通过某些方法，寻找到关于特征的一些有趣结构，看看能不能给他们分组。</p><p>图 9.2 是一个聚类算法，很明显 10 个数据被分成了两块，聚集成了两个集群的数据。</p><h3 id="_1-1-聚类算法的一些应用场景" tabindex="-1"><a class="header-anchor" href="#_1-1-聚类算法的一些应用场景"><span>1.1 聚类算法的一些应用场景</span></a></h3><figure><img src="/blog-vp-reco/machinelearning/four/09-03.png" alt="9.3 聚类算法的应用" width="560" tabindex="0" loading="lazy"><figcaption>9.3 聚类算法的应用</figcaption></figure><ol><li><p>在新闻网站上，聚合一些相似的新闻。</p></li><li><p>在代码网站上，比如牛客网、leetcode，有些人可能是想学习技能，有的人可能是为了找工作，有些人或许是想知道有什么 AI 模型可以对自己的工作产生帮助。我们可以通过聚类算法，将这些有相同目标的人划分到一起。</p></li><li><p>在 DNA 分析中，也常使用聚类算法，来找出一些蛋白质结构相同的特点。</p></li><li><p>在天文学领域中，寻找一些行星相关联的特性。</p></li></ol><h2 id="_2-k-means-算法" tabindex="-1"><a class="header-anchor" href="#_2-k-means-算法"><span>2. K-means 算法</span></a></h2><p>K-means 算法是聚类问题中，一个常用的算法。下面会通过原理、步骤、成本函数，以及一些构建 K-means 的技巧，来介绍这个算法。</p><h3 id="_2-1-k-means-原理" tabindex="-1"><a class="header-anchor" href="#_2-1-k-means-原理"><span>2.1 K-means 原理</span></a></h3><p>我们还是从举例子开始，假设我们有 30 个黄色的未标记的数据，分布如下图所示，我们要求它尝试找到两个集群。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-04.png" alt="9.4 K-means原理-1" width="560" tabindex="0" loading="lazy"><figcaption>9.4 K-means原理-1</figcaption></figure><p>（1）图 9.4 中的红叉和蓝叉，代表随机生成的两个集群的中心位置，它们被称之为<strong>簇质心</strong>。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-05.png" alt="9.5 K-means原理-2" width="560" tabindex="0" loading="lazy"><figcaption>9.5 K-means原理-2</figcaption></figure><p>（2）随后我们分别计算，所有数据和两个簇质心之间的距离，然后进行比较，将靠近红叉的数据标记为红色，将靠近蓝叉的数据标记为蓝色。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-06.png" alt="9.6 K-means原理-3" width="560" tabindex="0" loading="lazy"><figcaption>9.6 K-means原理-3</figcaption></figure><p>（3）分别计算红色数据和蓝色数据的平均值，记为 k1 和 k2。将簇质心红叉和蓝叉分别移动到 k1 和 k2 的位置上。</p><p>做完了一遍这些工作后，我们发现，新的簇质心会导致一些数据与其的距离产生变化，所以我们重复（2）和（3）的步骤，继续划分集群和移动簇质心，如下图所示，直到簇质心的位置不再变化。</p><div class="layout"><figure><img src="/blog-vp-reco/machinelearning/four/09-07.png" alt="9.7 K-means原理-4" width="360" tabindex="0" loading="lazy"><figcaption>9.7 K-means原理-4</figcaption></figure><figure><img src="/blog-vp-reco/machinelearning/four/09-08.png" alt="9.8 K-means原理-5" width="360" tabindex="0" loading="lazy"><figcaption>9.8 K-means原理-5</figcaption></figure><figure><img src="/blog-vp-reco/machinelearning/four/09-09.png" alt="9.9 K-means原理-6" width="360" tabindex="0" loading="lazy"><figcaption>9.9 K-means原理-6</figcaption></figure></div><h3 id="_2-2-k-means-算法" tabindex="-1"><a class="header-anchor" href="#_2-2-k-means-算法"><span>2.2 K-means 算法</span></a></h3><p>总结一下 2.1 小节内容，K-means 算法可以分为 3 个步骤：</p><p><strong>1. 随机猜测你可能要求它找到的两个（或几个）聚类的中心位置。</strong></p><p><strong>2. 遍历每一个点（数据），并查看它是更接近于哪个中心位置（簇质心）。打上不同的记号（在这个例子中用颜色进行区分）。</strong></p><p><strong>3. 通过取“不同记号数据”的平均值，重新计算簇质心的落点，并将其移动过去。</strong></p><p>其中 2 和 3 会重复进行。循环到簇质心的位置不再变化，数学上称之为收敛，就结束循环。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-10.png" alt="9.10 K-means算法伪代码" width="560" tabindex="0" loading="lazy"><figcaption>9.10 K-means算法伪代码</figcaption></figure><p>需要注意的是，聚类算法中有一个极端的情况，比如图中随机生成的两个簇质心，蓝色的没有数据最靠近它，它会计算 0 个点位的平均值，很明显会出错。</p><ul><li>解决办法 1：减少簇质点的数量（k=k-1）</li><li>解决办法 2：从随机分配的初始化步骤重新开始</li></ul><p>除此之外，聚类算法对簇群区别不是特别明显的数据也适用：</p><figure><img src="/blog-vp-reco/machinelearning/four/09-11.png" alt="9.11 K-means算法适用性" width="560" tabindex="0" loading="lazy"><figcaption>9.11 K-means算法适用性</figcaption></figure><p>左边是区分很明显的数据，右边是连续的、区分不明显的数据。</p><h3 id="_2-3-成本函数" tabindex="-1"><a class="header-anchor" href="#_2-3-成本函数"><span>2.3 成本函数</span></a></h3><p>在之前的很多监督学习算法的学习中，使用了梯度下降或其他的一些算法来优化成本函数。</p><p>而在上一小节中，我们发现 <strong>关键均值算法（K-means）</strong> 的簇质心是不断移动的，本质上也是在优化特定的成本函数。在这里，成本函数还有另一个名字，叫做 <strong>失真函数（distortion function）</strong>。</p><p>我们先来看一下成本函数的方程式：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mrow><mo fence="true">(</mo><msup><mi>c</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>c</mi><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">;</mo><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>μ</mi><mi>m</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><msub><mi>μ</mi><msup><mi>c</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></msub><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">J\left( c^{(1)},...,c^{(m)};\mu_{1},...,\mu_{m} \right) = \frac{1}{m}\sum_{i=1}^{m}\|x^{i}-\mu_{c^{(i)}}\| </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4694em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em;"><span style="top:-2.822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span></span></span></span></span></span></span><span class="mord">∥</span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">c^{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 代表分配给训练示例 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">x^{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 的索引数字；</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mu_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示集群质心 k 的位置；</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><msup><mi>c</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></msub></mrow><annotation encoding="application/x-tex">\mu_{c^{(i)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6612em;vertical-align:-0.2306em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4694em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em;"><span style="top:-2.822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span></span></span></span></span></span></span></span></span></span> 意味着该索引的数据已经分配到某个集群的集群质心，表示目前该数据所对应的集群质心。</li></ul><p>K-means 算法试图所做的，首先是找到聚类质心点的分配，其次是找到最小化平方距离的聚类质心的位置。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-12.png" alt="9.12 成本函数" width="560" tabindex="0" loading="lazy"><figcaption>9.12 成本函数</figcaption></figure><p>数据关于质心的分配，就是计算距离，看看该数据离哪一个质心更近。虽然这样做，保证了单独的每一个数据，离所属的质心最近，但是总体的方差却不是最小的。</p><p>移动簇质心的工作，其实就是将簇质心与其对应的数据之间的平方距离之和（总方差）最小化，由此可以得到这组数据的最中心的位置。</p><p>如下图所示，两个数据分别位于 1 和 11，而质心位于 2，此时的总方差为 41；1 和 11 的中心点位于 6，若将质心移动至此，总方差为 25，已经达到了最小。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-13.png" alt="9.13 移动簇质心" width="560" tabindex="0" loading="lazy"><figcaption>9.13 移动簇质心</figcaption></figure><p><strong>判断损失函数是否收敛</strong>的办法其实和梯度下降差不多：</p><ol><li>一段时间内，成本函数的大小已经不再变化了。</li><li>成本函数的下降速度已经变得非常非常慢。</li></ol><h3 id="_2-4-初始化-k-means" tabindex="-1"><a class="header-anchor" href="#_2-4-初始化-k-means"><span>2.4 初始化 K-means</span></a></h3><p>簇质心的数量一定是小于训练集数据大小 K 的，因为我们的目的是找到某些数据的相似之处，然后给这些数据划分成一个集群。如果集群的数量都大于数据数量了，就失去意义了。</p><p>在 2.2 小节中，我们是通过随机生成质心位置来完成初始化的。但其实，通过随机选取数据集中的数据，来完成初始化，更加的实用。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-14.png" alt="9.14 初始化 K-means" width="560" tabindex="0" loading="lazy"><figcaption>9.14 初始化 K-means</figcaption></figure><p>但这种方式，也会存在一些问题，比如可能会陷入局部最优解的境地。如上图所示，因为初始化质心的差异，J1 到 J3 都是局部最优，但是我们通过观察图可以知道，J1 才是最优的划分情况。</p><p><strong>我们可以通过多次随机初始化的方式，来对比不同的方式的总体方差。一般来说，初始化的次数是 50 到 1000 次，如果数据量不太大，最好在 50 到 100 次左右。</strong></p><p>J2 中蓝色的质心，它的方差会比红色和绿色大得多；而 J3 中红色质心的方差会比蓝色和绿色大得多；只有 J1 中的三个质心的方差相差不大。因此，通过对比，我们知道 J1 才是最优解。</p><h3 id="_2-5-选择聚类数量" tabindex="-1"><a class="header-anchor" href="#_2-5-选择聚类数量"><span>2.5 选择聚类数量</span></a></h3><p>上一小节，我们探讨了簇质心的初始化位置如何分配，那么一个具体的问题当中，需要多少个聚类数量（簇质心）呢？</p><figure><img src="/blog-vp-reco/machinelearning/four/09-15.png" alt="9.15 选择聚类数量" width="560" tabindex="0" loading="lazy"><figcaption>9.15 选择聚类数量</figcaption></figure><p>这个问题的答案其实是模糊的，因为没有标准答案。就比如上图给出的这一组数据，有的人来看，会划分成两个聚类（蓝色圈）；有的人来看，则可以划分成四个聚类（红色圈）。这两个答案都是对的。</p><p>如果你看过很多关于聚类的文献，你可能会找到一种叫做 <strong>肘部方法（Elbow method）</strong> 的算法，它可以自动的寻找合适的聚类数量，如下图中左边的图例所示。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-16.png" alt="9.16 肘部方法" width="560" tabindex="0" loading="lazy"><figcaption>9.16 肘部方法</figcaption></figure><p>肘部方法认为，聚类的数量增加到某一个值的时候，会像弯曲的手肘一样，导致成本函数下降的速度变得缓慢，因此，位于肘部的这个值，就是最佳的聚类数量。</p><p><strong>但是</strong>吴恩达教授说自己很少用这个方法，他认为成本函数和聚类数量的关系，大多数时候都是一条圆滑的曲线，没有肘部位置的存在。<strong>并且</strong>我们不能以聚类数量为标准，降低成本函数，通过右边图例的曲线，我们知道以聚类数量为标准，只会让聚类数量不断增加，最终等于训练示例数量。</p><p>因此，如何选择聚类的数量，要从具体的下游任务进行分析。比如：T 恤的大小如何进行划分。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-17.png" alt="9.17 T恤示例的聚类数量划分" width="560" tabindex="0" loading="lazy"><figcaption>9.17 T恤示例的聚类数量划分</figcaption></figure><p>我们可以分成三个聚类（S，M，L），也可以分成五个聚类（XS，S，M，L，XL）。我们衡量的标准可以是“哪种聚类数量的划分让衣服穿着更合身”，亦或许要考虑“制作更多尺码的 T 恤所需的额外成本”。</p><p>还有一个很有趣的视觉应用，是 K-means 算法在图像压缩中的应用。图像压缩中会有一个权衡点，即“压缩后的图像看起来有多好”。你可以通过对比，选择你觉得适合的聚类数量，来决定压缩后的图像大小有多大。</p><h2 id="_3-异常检测算法" tabindex="-1"><a class="header-anchor" href="#_3-异常检测算法"><span>3. 异常检测算法</span></a></h2><p>异常检测算法会查看未标记的正常事件数据集，从而学会检测异常事件，或发出危险信号。</p><p>举个例子，像飞机这种大型运输工具，如果出现发动机故障会产生非常负面的结果，所以有些科学家在研究使用“异常检测”来检测制造的飞机发动机，是否看起来有异常，或者它是否存在某种问题。</p><p>初步的想法是这样的，当飞机发动机停止运行后，它可能存在以下特征：</p><ul><li>x1=heat generated（发动机产生的热量）</li><li>x2=vibration intensity（振动强度）</li><li>and so on（等等一系列的特征）</li></ul><p>为了降低解释原理的难度，我们只用两个特征。我们知道发动机的制造肯定是很精细的过程，所以我们默认制造出来的发动机，都是没有问题的。</p><p>因此，我们通过获取某个飞机公司的许可，收集 m 台飞机发动机的运行特征 x1 和 x2。异常检测算法的工作是：看到这 m 个例子之后，概括出飞机引擎通常产生多少热量，以及他们的振动强度是多少。</p><p>如果一个全新的飞机发动机要下线，并且有一个 xtest 的新特征向量，我们想知道这个发动机看起来是否跟之前 m 台发动机相似。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-18.png" alt="9.18 异常检测-发动机1" width="560" tabindex="0" loading="lazy"><figcaption>9.18 异常检测-发动机1</figcaption></figure><h3 id="_3-1-密度估计-density-estimation" tabindex="-1"><a class="header-anchor" href="#_3-1-密度估计-density-estimation"><span>3.1 密度估计（density estimation）</span></a></h3><p>执行异常检测的最常见的方法是一个被称为密度估计的技术。当它获得一个样本的训练集时，它做的第一件事就是为 x 的概率建立一个模型。</p><p>换句话说，学习算法将会通过特征值 x1 和 x2 来尝试找出，哪些值在数据集中出现的概率大，哪些值在数据集中出现的概率较小。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-19.png" alt="9.19 异常检测-发动机2" width="560" tabindex="0" loading="lazy"><figcaption>9.19 异常检测-发动机2</figcaption></figure><p>通过图中模拟的三层椭圆，我们可以知道从里向外，飞机引擎正常的可能性逐渐降低。假设我们给出一个阈值 ε，也就是途中最外层的蓝色椭圆。</p><p>如果测试的数据概率小于阈值 ε（落在了篮圈外面），算法会觉得这个引擎可能存在问题；如果测试数据的概率大于阈值 ε（落在篮圈内），算法会觉得这个引擎看起来好像是正常的。</p><p>密度估计的常见应用：</p><ol><li>检测新生产的产品是否存在缺陷</li><li>检测金融网站是否存在欺诈问题</li><li>检测计算机的元件功率是否正常</li></ol><h3 id="_3-2-高斯分布-gaussian-distribution" tabindex="-1"><a class="header-anchor" href="#_3-2-高斯分布-gaussian-distribution"><span>3.2 高斯分布（Gaussian distribution）</span></a></h3><p>为了应用异常检测，我们需要使用高斯分布，也称为正态分布（The normal distribution）、或者钟形分布（The bell-shaped distribution）。</p><figure><img src="/blog-vp-reco/machinelearning/four/09-20.png" alt="9.20 高斯分布" width="560" tabindex="0" loading="lazy"><figcaption>9.20 高斯分布</figcaption></figure><p>我们先看右边这个图，假设我们有 100 个数据（x，y），并且它们符合正态分布，用曲线将直方图的顶点连接起来，就像是一个钟形的曲线，如同左边的图一样。</p><p>正态分布中的 μ 代表均值，σ 代表标准差（σ 的平方才是方差）。正态分布中，对于某个点的概率预测公式如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mfrac><msup><mi>e</mi><mfrac><mrow><mo>−</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></msup></mrow><annotation encoding="application/x-tex">p(x)=\frac{1}{\sqrt{2\pi}}e^{\frac{-(x-\mu)^{2}}{2\sigma^{2}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2591em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2028em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3291em;"><span style="top:-3.4534em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.251em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mi>x</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">\mu = \frac{1}{m}\sum_{i=1}^{m}x^{i} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo>∑</mo><mrow><mo fence="true">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>μ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^{2} = \frac{1}{m}\sum{\left(x^{(i)}-\mu\right)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></span></p><p><strong>高斯分布的一个性质为：概率总和永远等于 1 。</strong> 因此图像的面积是不会变的。μ 控制图像的中心点在 x 轴的某处，而 σ 控制图像的宽度：</p><ul><li>σ 越大，图像越宽，高度越低；</li><li>σ 越小，图像越窄，高度越高。</li></ul><figure><img src="/blog-vp-reco/machinelearning/four/09-21.png" alt="9.21 高斯分布的性质" width="560" tabindex="0" loading="lazy"><figcaption>9.21 高斯分布的性质</figcaption></figure><p>除了上述的性质之外，还有一个很重要的性质：某一个测试数据</p><ul><li>落在 [ μ-σ，μ+σ ] 中的概率为 67%</li><li>落在 [ μ-2σ，μ+2σ ] 中的概率为 95%</li><li>落在 [ μ-3σ，μ+3σ ] 中的概率为 99.7%</li></ul><p>通过这样一个性质，结合上一小节的内容，该怎么结合实际情况对阈值 ε 选择，我们似乎已经有了思路。</p><h3 id="_3-3-异常检测算法" tabindex="-1"><a class="header-anchor" href="#_3-3-异常检测算法"><span>3.3 异常检测算法</span></a></h3><p>假设我们训练集中有 m 个数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_{1},x_{2},...,x_{m})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，每个数据有 n 个特征。特征之间都是独立的，所以它的概率总和应该是所有特征的对应概率的乘积。（概率论与数理统计中的内容），用公式表示为：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">;</mo><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo>×</mo><mo>⋯</mo><mo>×</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">;</mo><msub><mi>μ</mi><mi>n</mi></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo separator="true">;</mo><msub><mi>μ</mi><mi>j</mi></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} p(x) &amp;=p(x_{1};\mu_{1},\sigma_{1}^{2}) \times\cdots\times p(x_{n};\mu_{n},\sigma_{n}^{2}) \\ &amp;= \prod_{j=1}^{n}p(x_{j};\mu_{j},\sigma_{j}^{2}) \end{align} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.8893em;vertical-align:-2.1946em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6946em;"><span style="top:-5.4819em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.1705em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1946em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6946em;"><span style="top:-5.4819em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.1705em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1946em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6946em;"><span style="top:-5.4819em;"><span class="pstrut" style="height:3.6514em;"></span><span class="eqn-num"></span></span><span style="top:-3.1705em;"><span class="pstrut" style="height:3.6514em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1946em;"><span></span></span></span></span></span></span></span></span></p><p>基于这个新公式，我们来总结一下异常检测算法的步骤：</p><p><strong>1. 首先选择 n 个你认为对异常检测有帮助的特征。</strong></p><p><strong>2. 用高斯分布拟合所有的参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>μ</mi><mi>n</mi></msub><mo separator="true">;</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mu_{1},...,\mu_{n};\sigma_{1}^{2},...,\sigma_{n}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></strong></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mi>x</mi><mi>i</mi></msup><mspace width="2em"></mspace><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo>∑</mo><mrow><mo fence="true">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>μ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu = \frac{1}{m}\sum_{i=1}^{m}x^{i} \qquad \sigma^{2} = \frac{1}{m}\sum{\left(x^{(i)}-\mu\right)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></span></p><p><strong>3. 用训练好的参数，计算一个测试集新数据的概率</strong></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo separator="true">;</mo><msub><mi>μ</mi><mi>j</mi></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><msub><mi>σ</mi><mi>j</mi></msub></mrow></mfrac><msup><mi>e</mi><mfrac><mrow><mo>−</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></msup></mrow><annotation encoding="application/x-tex">p(x) = \prod_{j=1}^{n}p(x_{j};\mu_{j},\sigma_{j}^{2}) = \prod_{j=1}^{n}\frac{1}{\sqrt{2\pi}\sigma_{j}}e^{\frac{-(x-\mu)^{2}}{2\sigma^{2}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2028em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0833em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3291em;"><span style="top:-3.4534em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.251em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong>4. 用概率和阈值 ε 做比较，小于则有异常，大于则无异常</strong></p><h3 id="_3-4-实数评估-real-number-evaluation" tabindex="-1"><a class="header-anchor" href="#_3-4-实数评估-real-number-evaluation"><span>3.4 实数评估（Real number evaluation）</span></a></h3><p>当你在开发学习算法时，比如选择不同的特征，或尝试不同的参数值（例如阈值 ε），你可能会有“是否以某种方式更改特征”、“增加或减少 epsilon（ε）或者其它参数”这样的决策。</p><p>那么改变之后的结果好不好，怎么判断？如果你有一种评估学习算法的方法，会比你训练很多次，然后亲自去对比数据容易得多。</p><p>这种方法有时候被称为<strong>实数评估</strong>。它可以用某种方式快速改变算法（比如改变一个特征或参数），并且有一种计算数字的方法可以告诉你这种改变是好是坏。</p><p>在异常检测中实数评估是一个经常被使用的方法。假设你多来年收集了 1 万个良好或正常的发动机数据，并且也收集到了 20 个有缺陷或异常的发动机数据。</p><p>我们将其做如下的划分：</p><ul><li>训练集：6000 个良好引擎</li><li>交叉验证集：2000 个良好引擎（y=0），10 个异常引擎（y=1）</li><li>测试集：2000 个良好引擎（y=0），10 个异常引擎（y=1）</li></ul><p>然后在训练集上训练算法，用高斯分布拟合这 6000 个数据，再在交叉验证集上，观察它正确标记了多少异常引擎。</p><p>我们可以通过调整交叉验证集的参数 epsilon（ε），将其调高或者降低，观察什么时候能够可靠的检测到这 10 个异常引擎。</p><p>再通过测试集，对交叉验证集的参数进行评估，看看它发现了 10 个异常引擎中的多少个，以及有没有将良好的引擎错误的标记为异常引擎。</p><p>如果你的异常引擎数据很少，比如只有 2 个，那么完全可以不要测试集，只保留训练集和交叉验证集。尽管这样做，没有办法对参数进行验证，但是当数据集太小的时候，这可能是最好的选择。</p><h3 id="_3-5-对比监督学习" tabindex="-1"><a class="header-anchor" href="#_3-5-对比监督学习"><span>3.5 对比监督学习</span></a></h3><p><strong>监督学习算法的本质是，希望从大量的正确示例中，学习到相关特征，然后预测与其相似的数据。</strong></p><p>比如，垃圾邮件归类的问题，我们通过给大量的垃圾邮件进行标记（y=1），让算法对特定类型的垃圾邮件有一个认识，然后对新的邮件进行检测，看其是否和学习到的垃圾邮件相似。如果相似，就将其标记为垃圾邮件。</p><p><strong>异常检测算法的本质，是排除异常的数据，是检测新数据与正常数据不一样的程度。</strong></p><p>比如，生产的零件质量检测，我们通过对大量优质的零件进行学习，用高斯分布拟合这些数据。如果新的零件，不符合这些优质零件的特征，就发出异常警告。</p><p>通过对比，我们知道监督学习算法也是可以做缺陷检测的，但是只能对已知的，有足够数据集的，也就是常见的缺陷进行检测。</p><p>而异常检测算法可以对未知的，不确定的错误进行排查。如果你觉得可能还会有某些想象不到的错误会出现，那么用异常检测算法会很有效。</p><h3 id="_3-6-特征选择" tabindex="-1"><a class="header-anchor" href="#_3-6-特征选择"><span>3.6 特征选择</span></a></h3><p>监督学习算法中，即使你有一些无关紧要的特征，或者选择的特征不完全正确，结果通常也不会有什么问题。</p><p>因为它必须有监督信号，该信号足以告诉算法，哪些特征可以忽略，哪些特征需要缩放等等，可以充分的利用提供的特征。</p><p>但是异常检测是无监督学习，只能从未标记的数据中进行学习，它很难找出需要忽略的特征。所以<mark>仔细选择特征对于异常检测算法来说很重要。</mark></p><p><strong>（1）让特征尽可能的拟合高斯分布。</strong></p><figure><img src="/blog-vp-reco/machinelearning/four/09-22.png" alt="9.22 特征变换拟合高斯分布" width="560" tabindex="0" loading="lazy"><figcaption>9.22 特征变换拟合高斯分布</figcaption></figure><p>我们可以通过线性变换，让某些不符合高斯分布的特征，变成符合的。</p><p>比如：log(x)，或者 log(x+C)，C 表示常数。 比如：开根号，平方根，立方根……</p><p>要注意的是，无论你对训练集使用了什么样的转换方式，对交叉验证集和测试集的数据，也应用同样的方式转换。</p><p><strong>（2）通过错误分析对某些特征进行调整。</strong></p><p>假设有某个数据，它的正常概率和异常概率都很大。通常我们会尝试查看该数据，并找到我认为的什么地方是异常的，即使这个数据的特征看起来和其它的并没有什么不同。</p><p>如果我能够识别出一些新特征，那将有助于这个数据与普通的数据区分开来。然后添加该特征，可以帮助提高算法的性能。</p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Git仓库提交时间 2025/9/21 01:39:30<!--]--></span></span></div></footer><nav class="page-nav"><p class="hasPrev hasNext inner"><span class="page-nav-item prev"> ← 2-4 决策树模型</span><span class="page-nav-item next">3-2 推荐系统 → </span></p></nav><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_1-什么是聚类" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="1. 什么是聚类"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->1. 什么是聚类<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_1-1-聚类算法的一些应用场景" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="1.1 聚类算法的一些应用场景"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->1.1 聚类算法的一些应用场景<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-k-means-算法" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2. K-means 算法"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2. K-means 算法<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-1-k-means-原理" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2.1 K-means 原理"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2.1 K-means 原理<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-2-k-means-算法" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2.2 K-means 算法"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2.2 K-means 算法<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-3-成本函数" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2.3 成本函数"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2.3 成本函数<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-4-初始化-k-means" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2.4 初始化 K-means"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2.4 初始化 K-means<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_2-5-选择聚类数量" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2.5 选择聚类数量"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2.5 选择聚类数量<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-异常检测算法" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3. 异常检测算法"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3. 异常检测算法<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-1-密度估计-density-estimation" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.1 密度估计（density estimation）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.1 密度估计（density estimation）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-2-高斯分布-gaussian-distribution" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.2 高斯分布（Gaussian distribution）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.2 高斯分布（Gaussian distribution）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-3-异常检测算法" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.3 异常检测算法"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.3 异常检测算法<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-4-实数评估-real-number-evaluation" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.4 实数评估（Real number evaluation）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.4 实数评估（Real number evaluation）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-5-对比监督学习" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.5 对比监督学习"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.5 对比监督学习<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog-vp-reco/blogs/MachineLearning/MachineLearning/09_unsupervised_learning.html#_3-6-特征选择" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="3.6 特征选择"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->3.6 特征选择<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/blog-vp-reco/assets/app-P8O63--9.js" defer></script>
  </body>
</html>
