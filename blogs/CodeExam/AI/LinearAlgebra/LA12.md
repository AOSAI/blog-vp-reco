---
title: LA12.计算向量之间的余弦相似度
date: 2025/09/29
categories:
  - 每日一题
tags:
  - AI题库
  - 线性代数
---

#### 难度：简单

实现一个函数来计算两个向量之间的余弦相似度。余弦相似度是通过测量两个向量之间的夹角的余弦值来度量它们之间的相似性。

- **输入描述**：
  1. 第一行为向量 v1，可以是一维或二维数组
  2. 第二行为向量 v2，维度需要与 v1 相同
- **输出描述**：输出一个浮点数，表示两个向量之间的余弦相似度，结果保留 3 位小数。

:::: code-group
::: code-group-item 代码框架

```py
import numpy as np

def cosine_similarity(v1, v2):
	# Implement your code here
    return round(val, 3)

if __name__ == "__main__":
    v1 = np.array(eval(input()))
    v2 = np.array(eval(input()))
    print(cosine_similarity(v1, v2))
```

:::

::: code-group-item 示例 1

```py
# 输入：
[1, 2, 3]
[4, 5, 6]

# 输出：
0.975
```

:::
::::

---

#### 衡量相关性/相似度的指标

1. 空间向量类：

- 欧氏距离 (Euclidean distance)：衡量几何直线距离，越小越相似。
- 曼哈顿距离 (Manhattan / L1 distance)：绝对值差的和，适合稀疏特征。
- 切比雪夫距离 (Chebyshev distance)：看坐标差的最大值。
- 闵可夫斯基距离 (Minkowski distance)：欧氏/曼哈顿的推广。
- ==马氏距离 (Mahalanobis distance)==：欧氏距离的协方差加权版，能考虑特征的尺度和相关性。
- ==汉明距离 (Hamming distance)==：曼哈顿距离的离散特例（仅对 0/1 向量）。

2. 相似度类（归一化后）：

- 点积 (Dot product)：没有归一化的余弦相似度，会受向量长度影响。
- ==余弦相似度 (Cosine similarity)==：基于夹角，等价于归一化点积。
- 雅卡尔相似度 (Jaccard similarity)：常用于集合，但向量（特别是二值向量）也可用。
- Dice 系数 (Sørensen–Dice coefficient)：类似 Jaccard，用于比较重叠度。

3. 统计相关性类：

- 皮尔逊相关系数 (Pearson correlation coefficient)：衡量线性相关，范围 -1 ~ 1。
- 斯皮尔曼等级相关系数 (Spearman rank correlation)：非线性单调关系也能捕捉。
- 肯德尔相关系数 (Kendall’s tau)：基于排序一致性。

4. 信息论类：

- KL 散度 (Kullback–Leibler divergence)：衡量两个分布的差异（非对称）。
- JS 散度 (Jensen–Shannon divergence)：对称的 KL 变体，更常用。
- 互信息 (Mutual Information)：衡量共享信息量。

#### 余弦相似度

==余弦相似度（Cosine Similarity）== 是一种用于度量两个向量之间相似性的方法，通常在多维空间中使用。它衡量了两个向量之间夹角的余弦值，从而提供了一种评估它们之间关系的方式。数学计算公式如下：

$$
\text{Cosine Similarity}(A,B) = \frac{\vec{A}\cdot{\vec{B}}}{||\vec{A}||+||\vec{B}||}
$$

其中，A 和 B 是要比较的向量；||A|| 与 ||B|| 表示向量的模长，通过计算每个向量元素的平方和，然后取平方根得到。之所以说它是归一化的向量点积，因为它除以了自己的模长，让范围在 [-1, 1] 之间。也是因此，它只受方向的干扰，不受长度的影响，适用于任何维度向量的比较。

- ==越接近 1==:表示两个向量之间的的方向越靠近，相似度越高。
- ==等于 0 时==：表示两个向量之间不存在线性关系，是不相关的。
- ==越接近 -1==:表示两个向量在多维空间中的方向正好相反，它们是完全不同的。

余弦相似性通常用于文本处理、信息检索、推荐系统和聚类分析等领域：

- **文本处理（NLP）**：在自然语言处理中，可以使用余弦相似性来比较文档、句子或词向量，以确定它们之间的相似性，用于信息检索、文本分类和推荐系统。
- **图像处理（CV）**：在计算机视觉中，可以使用余弦相似性来比较图像特征向量，用于图像检索和相似图像查找。
- **推荐系统（RS）**：在推荐系统中，可以使用余弦相似性来比较用户与商品之间的偏好向量，从而提供个性化的推荐。
- **聚类分析（CA）**：在聚类分析中，余弦相似性可用于度量样本之间的相似性，从而将相似的样本聚集在一起。

#### 解题思路 1：Numpy

Numpy 中没有现成的函数，但是可以通过范数函数简化计算步骤，==np.linalg.norm(x, ord)== 函数用于计算 向量/矩阵 范数，主要区别在于 ord 这个参数：

| 向量                   | 参数         | 矩阵                 | 参数         |
| ---------------------- | ------------ | -------------------- | ------------ |
| L1 范数（曼哈顿）      | 1            | Frobenius 范数       | 'fro'        |
| L2 范数（欧几里得）    | ==2 / None== | 核范数（奇异值和）   | 'nuc'        |
| L∞ 范数（最大绝对值）  | np.inf       | 谱范数（最大奇异值） | ==2 / None== |
| L-∞ 范数（最小绝对值） | -np.inf      | 列和的最大值         | 1            |
| Lp 范数（一般形式）    | p            | 行和的最大值         | np.inf       |

|

```py
def orthogonal_projection(v, L):
    length = len(L)
    L2 = sum([item*item for item in L])**0.5
    v_new = [v[i]*L[i] for i in range(length)]
    result = [round((v_new[i]/L2)*L[i], 3) for i in range(length)]
    return result
```

#### 解题思路 1：Python 数组手搓

Python 求平方根的方法有很多种：使用指数运算符 **\*\*0.5**、使用 **pow(x, 0.5)** 函数、使用 math 数学标准库 **math.sqrt(x)**。保留三位小数，可以使用 ==round(x,3)== 函数四舍五入，剩下的就是直接计算即可。

```py
def orthogonal_projection(v, L):
    length = len(L)
    L2 = sum([item*item for item in L])**0.5
    v_new = [v[i]*L[i] for i in range(length)]
    result = [round((v_new[i]/L2)*L[i], 3) for i in range(length)]
    return result
```
