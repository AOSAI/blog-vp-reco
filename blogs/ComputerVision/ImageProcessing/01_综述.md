---
title: 图像处理综述
date: 2025/08/21
categories:
  - 计算机视觉
tags:
  - 图像处理
  - OpenCV
  - Pillow
  - 综述
---

## 1. 图像处理的定义与范围

图像处理（Image Processing）是对数字图像进行操作，以达到改善图像质量、提取信息或实现特定应用的目的。其范围横跨基础操作、增强与复原、压缩、分析等多个层面。在计算机视觉（Computer Vision, CV）体系中，图像处理既是底层工具，也是更高级任务（检测、识别、理解）的前提。

### 1.1 基础操作

基础操作是图像处理的起点，主要包括 **图像的输入输出与数据格式处理**、**色彩空间转换**、**几何空间变换** 等内容。

1. ==输入输出与数据格式== 为后续处理提供了数据基础，如图像的读取、显示、存储与数据类型管理；
2. ==色彩空间转换== 通过在 RGB、HSV、Lab 等空间间切换，实现亮度与色彩信息的分离，便于分割、增强或特定视觉任务的实现；
3. ==几何空间变换== 则涵盖了缩放、旋转、翻转、仿射与透视等操作，用于图像校正与数据增强。

这些操作虽然简单，但几乎贯穿所有图像处理流程，是学习 OpenCV 的必备入门环节，也是理解更复杂算法的基础。

### 1.2 图像增强

图像增强主要分为 **平滑处理**、**锐化处理**、**直方图均衡化** 三个方面。

1. ==平滑处理== 主要用于削弱图像中的噪声与细微纹理，使整体画面更加自然、连续；
2. ==锐化处理== 通过增强图像的边缘与细节，提升视觉清晰度和结构感；
3. ==直方图均衡化== 则通过调整灰度分布，改善对比度，使暗区更清晰、亮区更细腻。

这些方法虽然处理方式不同，但共同目标都是突出人眼或后续计算机视觉任务所需的关键信息，因此在图像预处理、目标检测、医学成像、古画修复等应用中都有广泛使用。

### 1.3 图像复原（去噪、去模糊）

目的：从退化的图像中尽可能恢复原始图像。

- 噪声模型：高斯噪声、椒盐噪声、泊松噪声
- 去噪方法
  - 空域滤波（中值滤波）
  - 频域滤波（低通滤波）
  - 高级方法：非局部均值（NLM）、BM3D、小波去噪
- 去模糊
  - 均值运动模糊去卷积（去卷积：卷积的逆运算）
  - 维纳滤波（Wiener Filtering）
  - 盲去卷积（Blind Deconvolution）

👉 和“增强”不同，复原假设有退化模型（噪声/模糊机制已知），目标是重建原始图像。

### 1.4 图像压缩（JPEG、PNG）

目的：在有限存储/传输资源下，减少图像数据量。

- 无损压缩
  - PNG、GIF、TIFF
  - 基于熵编码（霍夫曼编码、LZW）
- 有损压缩
  - JPEG（离散余弦变换 DCT + 量化 + 熵编码）
  - WebP/HEIC（更高压缩率）

关键点：压缩要在存储效率和视觉质量之间平衡。

### 1.5 图像分析（分割、特征、识别）

目的：从图像中提取有用信息，进入计算机视觉层面。

- 图像分割
  - 阈值分割（Otsu）、边缘分割、区域生长
  - 现代方法：语义分割（FCN、U-Net）
- 特征提取
  - 经典：SIFT、SURF、ORB（关键点 + 描述子）
  - 深度学习：CNN 特征（ResNet、VGG）
- 模式识别 / 目标检测
  - 人脸识别、目标检测（YOLO、Faster R-CNN）
  - OCR（光学字符识别）

## 2. OpenCV 与 Pillow

OpenCV 的定位是**计算机视觉库**，涵盖图像处理、特征提取、视频处理、目标检测、机器学习接口等。在后续的内容里，主要使用 OpenCV 进行代码演示。

Pillow (PIL)：定位是**图像基础操作库**，比如加载/保存图片、裁剪、旋转、滤镜、简单绘制等，适合快速处理图像文件。

它们是目前最受欢迎，也是最常用的两个图像处理的库。虽然 OpenCV 覆盖了 Pillow 的大部分功能（特别是基础的读写、变换、滤镜等），但 Pillow 是 Python 集成的，相对比较轻量化一点，也有很多优点（见 2.1 Pillow），在某些应用场景中二者常常互补。

### 2.1 Pillow

Pillow 是 Python Imaging Library（PIL）的一个分支，中文版的官方文档写的很好：[Pillow 官方文档 - 中文](https://pillow.ac.cn/en/stable/index.html)。它的优势可以总结为以下几点：

**1. 更丰富的图像格式支持**

- Pillow 对各种冷门/专业的图像格式支持更好：GIF（含动图帧操作）；ICO、ICNS（图标格式）；TIFF（多页 TIFF，尤其是科研/扫描领域常用）；EPS（PostScript）。
- OpenCV 主要支持 常见格式（jpg、png、bmp、tiff 部分），动图、矢量、图标这类就不行。

比如，Pillow 可以直接读取动图的多帧，逐帧修改再保存回去，但 OpenCV 加载 GIF 只会拿到第一帧，不支持多帧动图编辑。

**2. 图像绘制更直观**

- Pillow 提供了 ImageDraw，可以很方便地：绘制点、线、矩形、圆、多边形；添加文字（ImageFont 支持各种字体、字号、ttf 字体加载）。
- OpenCV 也有绘制接口（cv2.line、cv2.putText），但：字体支持非常有限（只有 Hershey 系列，不能随意加载中文/自定义字体）；绘制效果比较“硬核”，不如 Pillow 灵活。

👉 如果你要做 生成海报、加水印、绘制带中文的图形，Pillow 完胜。

**3. 和 Python 标准库/生态结合更紧密**

- Pillow 是 Python 社区的“官方图像处理库”，跟 io.BytesIO、requests、Django/Flask 等框架结合特别顺滑。例如，Pillow 对接 Web 开发（上传、缩略图、裁切头像）几乎是默认选择。
- OpenCV 更偏 科研 / 工业应用，在 Web/服务端场景没那么常见。

**4. 图像合成 / 透明度支持**

- Pillow 的 paste()、alpha_composite() 很适合做图像合成，支持透明 PNG、Alpha 通道混合。
- OpenCV 也能做，但需要手写 mask、通道操作，相对麻烦。

### 2.2 OpenCV

OpenCV（Open Source Computer Vision Library）是一个开源的计算机视觉库，由英特尔公司于 1999 年发起。它提供了大量的图像处理和计算机视觉功能，广泛应用于物体识别、面部识别、图像分割等领域。

OpenCV 是用 C/C++ 编写的，具有很高的处理速度，适合处理大规模图像数据。支持 Python、C++、Java 等多种编程语言，Python 是最常用的接口。同时，它还支持深度学习模型的推理，可以加载 TensorFlow、Caffe、Torch 等框架的模型。

## 3. Python 中使用 OpenCV

### 3.1 Python 解释器

Python 是一个解释型的高级编程语言，安装了 Python 就相当于安装了解释器，它可以让我们直接解析和运行 .py 文件。[《Python 官网》](https://www.python.org/)。

但是学习的话，大多都直接安装 Anaconda，它将 “环境管理” + “包管理” 融为一体，比较方便我们使用。[《Anaconda 下载地址》](https://www.anaconda.com)。

### 3.2 集成开发环境（IDE）

Python 的主流 IDE 都是跨平台的：VS Code、PyCharm、JupyterLab。它们本质上就是一个「开发环境 + 编辑器」，只要你本地能安装 Python 解释器，就能跑。Win / macOS / Linux 基本体验差不多，不会因为系统不同，导致换 IDE。

### 3.3 安装与使用

```py
pip install opencv-python  # 安装命令
import cv2  # 导入代码
print(cv2.__version__)  # 验证是否导入成功
```

## 4. C++ 安装使用 OpenCV

### 4.1 安装 Visual Studio 2022

1. 打开 [Visual Studio 官网](https://visualstudio.microsoft.com/zh-hans/vs/)，在 **下载** 下拉框中选择 **社区版 2022（Community 2022）**。

2. 打开下载的 exe 文件，根据你的开发需求选择安装。一般来说，如果只是为了用 C++结合 OpenCV 写点东西，选择一个 **使用 C++的桌面开发** 就够了，右边栏里的选项默认即可。

![4.1 安装C++](/cv/ImageProcessing/01_xxx/00-02.png =560x)

3. 选择安装路径时，需要注意两点：（1）最好不要安装在 C 盘，并且不要出现中文路径。（2）缓存文件和安装文件不能放在同一个文件夹里，最简单的办法就是，只改变根路径（比如 C:\Program Files\ ......），子路径保持不变（变为 D:\VS\ ......）。

![4.2 选择安装路径](/cv/ImageProcessing/01_xxx/00-03.png =560x)

4. 安装好之后，登录与否看你心情。创建一个新项目 --> 选择 **空项目** --> 设置项目路径 --> 在文件结构中选择 **源文件**，右键创建一个 cpp 文件，输入以下代码，测试是否能够成功运行。

```C++
#include <stdio.h>
using namespace std;

int main()
{
    printf("Hello World");
    return 0;
}
```

### 4.2 下载 OpenCV

打开 C++所使用的 OpenCV 资源网站：[OpenCV 下载中心](https://opencv.org/releases/)，下载一个你需要的版本。没有具体要求，就下载倒数第二新的版本，防止出错。

![4.3 安装OpenCV](/cv/ImageProcessing/01_xxx/00-04.png =560x)

就比如这里，最新的是 4.10.0 版本，我们就下载 4.9.0 版本的 windows 安装包就行。在运行下载好的 opencv-4.9.0-windows.exe 文件时，除了选择安装位置外，其余都默认。==假设我们安装在 D:\OpenCV 路径下==

### 4.3 IDE 项目中配置 OpenCV

1. 点击刚才创建好的项目，再点击上方的 **小扳手** 按钮，打开项目的属性页。

![4.4 安装OpenCV](/cv/ImageProcessing/01_xxx/00-05.png =560x)

2. 找到 **CV++目录** 中的 **外部包含目录** 和 **库目录**。将 OpenCV 安装路径下的这两个路径，分别写入。

- D:\OpenCV\opencv\build\include --> 外部包含目录
- D:\OpenCV\opencv\build\x64\vc16\lib --> 库目录

![4.5 C++项目配置OpenCV1](/cv/ImageProcessing/01_xxx/00-06.png =560x)

以第一个为例，**外部包含目录**的最右侧有一个下拉框 --> 点击 **编辑** --> 粘贴**D:\OpenCV\opencv\build\include** --> 点击 **确认按钮**，完成操作。

3. 找到 **链接器** 中的 **输入**，第一项为 **附加默认项**，同样的操作，把 OpenCV 刚才 \build\x64\vc16\lib 路径下的 opencv_world4100d.lib 文件路径，复制粘贴进去。

- "D:\OpenCV\opencv\build\x64\vc16\lib\opencv_world4100d.lib"

==需要注意的是：==

- opencv_world4100d.lib 文件表示在 Debug 模式下运行
- opencv_world4100.lib 文件表示在 Release 模式下运行

我在图 4.4 和图 4.5 中已经用橙色的方框圈起来了，VS 中默认运行的是 Debug 模式。如果你需要在 Release 模式下运行，请在属性页，配置处，修改为 Release，然后重复上述步骤。

4. 复制粘贴以下代码，如果不报错，并且能成功运行，即为该项目配置 OpenCV 成功。

```C++
#include <stdio.h>
#include <opencv2/opencv.hpp>

using namespace std;
using namespace cv;

int main()
{
    // 输出 OpenCV 版本
    printf(CV_VERSION);
    return 0;
}
```
